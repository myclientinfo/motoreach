<?php$small_array = array();$long_array = array();foreach($table_fields as $field){	if(!isset($field_mapping[$field]) || $field_mapping[$field]['type']=='text' || $field_mapping[$field]['type']=='longtext'){		$long_array[] = $field;	} elseif($field_mapping[$field]['type']=='smalltext'){		$small_array[] = $field;	}	}?><style>#admin_form, table.admin_list {	width: 900px;	margin: 0px auto;}label {	float:left;	font-size:12px;	font-weight:bold;	width:100px;}<?php if(!empty($small_array)){ ?>#<?php echo implode(', #', $small_array) ?>{	width: 100px;}<?php } ?><?php if(!empty($long_array)){ ?>#<?php echo implode(', #', $long_array) ?>{	width: 200px;}<?php } ?>#left_col, #right_col {	width: 400px;	float: left;	}#left_col {	margin-right: 30px;}#submit_item_opt_right {width: 500px; float: right;}</style><?php if(isset($javascript)&& $javascript){?><script src="/js/<?php echo $javascript?>.js"></script><?php } ?><?phpif(!isset($no_container)) echo '<div id="inner_content_white">';if(!$list){if(!isset($_REQUEST['dialer'])){if(!isset($no_nav)){?><h2>Edit <?php echo ucwords($type)?></h2><a href="/admin/">Admin Home</a> :: <a href="<?php echo $_SERVER['PHP_SELF'] ?>"><?php echo ucwords($type) ?> List</a>  :: <a href="<?php echo basename($_SERVER['PHP_SELF']) ?>?<?php echo $table_fields[0] ?>=0">New <?php echo ucwords($type) ?></a><br /><br /><?php}}echo Site::drawForm('admin_form', $_SERVER['PHP_SELF'].'?'.$_SERVER['QUERY_STRING']);foreach($table_fields as $field){	if(isset($table_field_mapping[$field]['type']) && $table_field_mapping[$field]['type'] =='skipped' ) continue;	if(isset($insert['before'][$field])) echo $insert['before'][$field];		if(!isset($table_field_mapping[$field])){		echo Site::drawText($field, @$content[$field], ucwords(str_replace('_',' ',$field))).BR;	} else {			$label = isset($table_field_mapping[$field]['label']) ? $table_field_mapping[$field]['label'] : ucwords(str_replace('_',' ',$field));				if($table_field_mapping[$field]['type'] == 'select'){			$tfm = $table_field_mapping[$field];			$lookup_values = Site::getLookupTable($tfm['table'], $tfm['key'], $tfm['value'], false, false, 'None');		}				$b = isset($no_br) && in_array($field, $no_br) ? '' : BR; 				//print_r($field);		if($_SESSION['l10n']['country_code'] == 'IE' && $field == 'city'){			$lookup_values = Site::getLookupTable('regions', 'id', 'region', 'region', false, false, false, false, 'state_id > 9');			echo Site::drawSelect($field, $lookup_values, @$content[$field], '', 'City', true).$b; 			//			print_r($field);		} else if($_SESSION['l10n']['country_code'] == 'IE' && $field == 'zip') {		echo Site::drawHidden($field, @$content[$field]);		} else {			switch($table_field_mapping[$field]['type']){				case 'hidden': echo Site::drawHidden($field, @$content[$field]); break;				case 'timestamp': echo Site::drawHidden($field, @$content[$field]); break;				case 'text': echo Site::drawText($field, @$content[$field], $label).$b; break;				case 'longtext': echo Site::drawTextArea($field, @$content[$field], $label).$b; break;				case 'smalltext': echo Site::drawText($field, ($field=='password'?'':@$content[$field]), $label).$b; break;				case 'select': echo Site::drawSelect($field, $lookup_values, @$content[$field], '', $label, true).$b; break;				case 'manual_select': echo Site::drawSelect($field, $manual_select[$field], @$content[$field], @$content[$field], $table_field_mapping[$field]['label'], true).$b; break;				case 'no_yes': echo Site::drawSelect($field, array('No', 'Yes'), @$content[$field], '0', $label).$b; break;			}		}			}		if(isset($insert['after'][$field])) echo $insert['after'][$field];}if(User::hasPermission('Admin')){	if(isset($_REQUEST['dialer'])) echo Site::drawSubmit('save', 'save ' . strtolower($type));		else echo Site::drawCustomSubmit('save ' . strtolower($type));	} echo Site::drawForm();if(isset($ajax_content)){	echo Site::drawDiv('ajax_content');	echo Site::drawDiv();}} else { if(!isset($_GET['page'])){	$_GET['page'] = 1;}if(!isset($no_nav)){ 	echo '<h2>List '.ucwords($type).'</h2>';?><a href="index.php">Admin Home</a> :: <a href="<?php echo basename($_SERVER['PHP_SELF']) ?>"><?php echo ucwords($type) ?> List</a> :: <a href="<?php echo basename($_SERVER['PHP_SELF']) ?>?<?php echo $table_fields[0] ?>=0">New <?php echo ucwords($type) ?></a><br /><br /><?php}echo isset($pre_list) ? $pre_list : '';?><table id="admin_list" align="center"><tr><?php foreach($list_header as $h){	echo '<th><a href="?ob='.$h;	if(isset($_GET['ob']) && $_GET['ob'] == $h && $_GET['od'] == 'ASC'){		echo '&od=DESC';	} else {		echo '&od=ASC';	}	if($_GET['page']>1){		echo '&page='.$_GET['page'];	}	foreach($_GET as $k =>$v){		if(in_array($k, array('od','ob', 'page'))) continue;		echo '&'.$k.'='.$v;	}	echo '">';	echo isset($table_field_mapping[$h]['label']) ? $table_field_mapping[$h]['label'] : ucwords(str_replace('_',' ',$h));	echo '</a>';	if(isset($_GET['ob']) && $_GET['ob'] == $h){		echo '<img src="/images/admin_'.( $_GET['od']=='DESC' ? 'up' : 'down' ).'.png">';	}	echo '</th>';} ?>    <th width="50"></th></tr><?php$i=1;$total = @$content['total'];unset($content['total']);$per_page = isset($_GET['num'])?$_GET['num'] : 30;$page_count = ceil($total / $per_page);foreach($content as $c){ ?><tr style="background-color: #<?php echo ($i%2?'EBEBEB':'FFFFFF')?>"><?php foreach($list_header as $h){	$val = $c[$h];		if(isset($table_field_mapping[$h])&&$table_field_mapping[$h]['type']=='no_yes'){		$val = $val?'Yes':'No';	} elseif(isset($table_field_mapping[$h])&&$table_field_mapping[$h]['type']=='timestamp'){		$val = date('d F Y', $val);	}  		?>	<td><?php echo $val ?></td>	<?php } ?>    <td><a href="<?php basename($_SERVER['PHP_SELF'])?>?<?php echo $table_fields[current($table_fields)] . '='.$c[$table_fields[current($table_fields)]] ?>">edit</a></td></tr><?php    $i++;}?></table><?php if(!isset($no_pages)){ ?><div id="page_links">Displaying <?php echo Site::drawForm('set_count', '', 'GET');foreach($_GET as $k =>$v){	if($k=='num') continue;	echo Site::drawHidden($k, $v);	}echo Site::drawSelect('num', array('30'=>'30', '50'=>'50', '100'=>'100'), (isset($_GET['num'])?$_GET['num']:''), 30);echo Site::drawForm();?> of <?php echo $total ?> records.<br /><br /><?php$get_array = $_GET;unset($get_array['page']);//echo $page_count.'<br>';//echo ;for($i=1;$i<=$page_count;$i++){    		if($i != $_GET['page']){		echo '<a class="pages" href="?page='.$i.'&';		echo http_build_query($get_array);		echo '" class="pages">';	}	echo $i;	if($i != $_GET['page']){		echo '</a>';	}		    echo (!$i%10?'<br>':'');}?></div><?php 	}}if(!isset($no_container)) echo '</div>';